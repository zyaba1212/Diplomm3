{% block content %}
<!-- Loading overlay -->
<div id="loading" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #0a0a1a; display: flex; justify-content: center; align-items: center; z-index: 1000; color: #00ffff; font-size: 24px;">
    –ó–ê–ì–†–£–ó–ö–ê 3D –ì–õ–û–ë–£–°–ê...
</div>

<!-- Globe container -->
<div id="globe-container" style="width: 100%; height: 80vh; position: relative;"></div>

<!-- Control panel -->
<div style="position: absolute; top: 20px; right: 20px; background: rgba(30, 30, 46, 0.9); padding: 15px; border-radius: 8px; border: 1px solid #8a2be2; z-index: 100; color: white; font-family: monospace;">
    <h3 style="margin-top: 0; color: #00ffff;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–ª–æ–±—É—Å–æ–º</h3>
    
    <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 15px;">
        <button onclick="window.globe.toggleRotation()" style="background: #8a2be2; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer;">
            <span id="rotation-icon">‚è∏</span> –í—Ä–∞—â–µ–Ω–∏–µ
        </button>
        
        <button onclick="window.globe.resetView()" style="background: #00ffff; color: black; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer;">
            ‚ü≤ –°–±—Ä–æ—Å –≤–∏–¥–∞
        </button>
        
        <button onclick="window.globe.zoomIn()" style="background: #333135; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer;">
            + –ü—Ä–∏–±–ª–∏–∑–∏—Ç—å
        </button>
        
        <button onclick="window.globe.zoomOut()" style="background: #333135; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer;">
            - –û—Ç–¥–∞–ª–∏—Ç—å
        </button>
        
        <button onclick="window.globe.toggleEquipment()" style="background: #ff6600; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer;">
            <span id="equipment-icon">üîß</span> –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
        </button>
        
        <button onclick="window.globe.toggleCables()" style="background: #00ffff; color: black; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer;">
            <span id="cables-icon">üîó</span> –ö–∞–±–µ–ª–∏
        </button>
    </div>
    
    <div style="margin-top: 10px;">
        <label style="display: block; margin-bottom: 5px; color: #00ffff;">–¢–∏–ø —Å–µ—Ç–∏:</label>
        <select onchange="window.globe.switchNetwork(this.value)" style="background: #2e2d2e; color: white; border: 1px solid #8a2be2; padding: 5px; border-radius: 5px; width: 100%;">
            <option value="existing">–°—É—â–µ—Å—Ç–≤—É—é—â–∞—è —Å–µ—Ç—å</option>
            <option value="proposed">–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è —Å–µ—Ç—å (SUI + Starlink)</option>
            <option value="hybrid">–ì–∏–±—Ä–∏–¥–Ω–∞—è —Å–µ—Ç—å</option>
        </select>
    </div>
</div>

<!-- Network info -->
<div style="position: absolute; bottom: 20px; left: 20px; background: rgba(30, 30, 46, 0.9); padding: 15px; border-radius: 8px; border: 1px solid #00ffff; z-index: 100; color: white; font-family: monospace; max-width: 300px;">
    <h4 style="margin-top: 0; color: #00ffff;">–ì–ª–æ–±–∞–ª—å–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞</h4>
    <p style="margin: 5px 0;">üåê <strong id="node-count">8</strong> —É–∑–ª–æ–≤ —Å–µ—Ç–∏</p>
    <p style="margin: 5px 0;">üîó <strong id="cable-count">8</strong> –ø–æ–¥–≤–æ–¥–Ω—ã—Ö –∫–∞–±–µ–ª–µ–π</p>
    <p style="margin: 5px 0;">üîß <strong id="equipment-count">4</strong> –µ–¥–∏–Ω–∏—Ü –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</p>
    <p style="margin: 5px 0; font-size: 12px; color: #aaa;">–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –æ–±—ä–µ–∫—Ç –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</p>
</div>
{% endblock %}

{% block extra_js %}
<!-- Three.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>

<!-- Full globe with cables -->
<script src="{% static 'js/globe3d_full.js' %}"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('Initializing full globe...');
    
    setTimeout(function() {
        // Hide loading
        const loading = document.getElementById('loading');
        if (loading) loading.style.display = 'none';
        
        // Initialize globe
        try {
            if (typeof NetworkGlobe !== 'undefined') {
                window.globe = new NetworkGlobe('globe-container');
                console.log('‚úÖ Full globe initialized with cables!');
                
                // Update counters
                setTimeout(function() {
                    document.getElementById('node-count').textContent = window.globe.nodes.length;
                    document.getElementById('cable-count').textContent = window.globe.connections.length;
                    document.getElementById('equipment-count').textContent = window.globe.equipment.length;
                }, 1000);
                
                // Window resize handler
                window.addEventListener('resize', function() {
                    if (window.globe && window.globe.onWindowResize) {
                        window.globe.onWindowResize();
                    }
                });
            } else {
                console.error('NetworkGlobe class not found');
            }
        } catch (error) {
            console.error('Globe initialization error:', error);
        }
    }, 1500);
});
</script>
{% endblock %}